<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.petrochina.e7.monitor.dao.MechanicalExcelMapper">
    <resultMap id="BaseResultMap" type="com.petrochina.e7.monitor.pojo.MechanicalExcel">
        <id column="ID" property="id" jdbcType="INTEGER"/>
        <result column="EXCEL_NAME" property="excelName" jdbcType="VARCHAR"/>
        <result column="ORG_ID" property="orgId" jdbcType="INTEGER"/>
        <result column="ORG_NAME" property="orgName" jdbcType="VARCHAR"/>
        <result column="FACTORY_CATAGORY" property="factoryCatagory" jdbcType="VARCHAR"/>
        <result column="MINE_CATAGORY" property="mineCatagory" jdbcType="VARCHAR"/>
        <result column="TEAM_CATAGORY" property="teamCatagory" jdbcType="VARCHAR"/>
        <result column="SERIAL_NUMBER" property="serialNumber" jdbcType="INTEGER"/>
        <result column="WELL_NUMBER" property="wellNumber" jdbcType="VARCHAR"/>
        <result column="TEST_DATE" property="testDate" jdbcType="VARCHAR"/>
        <result column="PUMPING_MODEL" property="pumpingModel" jdbcType="VARCHAR"/>
        <result column="PUMP_FACTORY_DATE" property="pumpFactoryDate" jdbcType="VARCHAR"/>
        <result column="PUMP_MANU" property="pumpManu" jdbcType="VARCHAR"/>
        <result column="MOTOR_MODEL" property="motorModel" jdbcType="VARCHAR"/>
        <result column="MOTOR_ELIMINATION_EQUIP" property="motorEliminationEquip" jdbcType="VARCHAR"/>
        <result column="MOTOR_RATE_POW" property="motorRatePow" jdbcType="VARCHAR"/>
        <result column="MOTOR_RATE_CURRENT" property="motorRateCurrent" jdbcType="VARCHAR"/>
        <result column="MOTOR_RATE_VOLTAGE" property="motorRateVoltage" jdbcType="VARCHAR"/>
        <result column="MOTOR_RATE_SPEED" property="motorRateSpeed" jdbcType="VARCHAR"/>
        <result column="MOTOR_FACTORY_DATE" property="motorFactoryDate" jdbcType="VARCHAR"/>
        <result column="MOTOR_MANU" property="motorManu" jdbcType="VARCHAR"/>
        <result column="DBOX_MODEL" property="dboxModel" jdbcType="VARCHAR"/>
        <result column="DBOX_FACTORY_DATE" property="dboxFactoryDate" jdbcType="VARCHAR"/>
        <result column="DBOX_COMPENSATION" property="dboxCompensation" jdbcType="VARCHAR"/>
        <result column="DBOX_MANU" property="dboxManu" jdbcType="VARCHAR"/>
        <result column="DBOX_OPER_FREQUENCY" property="dboxOperFrequency" jdbcType="VARCHAR"/>
        <result column="DBOX_OPER_VLTAGE" property="dboxOperVltage" jdbcType="VARCHAR"/>
        <result column="OIL_TYPE" property="oilType" jdbcType="VARCHAR"/>
        <result column="BLOCK_PERMEABILITY" property="blockPermeability" jdbcType="VARCHAR"/>
        <result column="WELL_TRAJ" property="wellTraj" jdbcType="VARCHAR"/>
        <result column="OPER_FREQUENCY" property="operFrequency" jdbcType="VARCHAR"/>
        <result column="RUNTIME_DAY" property="runtimeDay" jdbcType="VARCHAR"/>
        <result column="ACTIVE_POWER" property="activePower" jdbcType="VARCHAR"/>
        <result column="NEGATIVE_BATTERY" property="negativeBattery" jdbcType="VARCHAR"/>
        <result column="CUMULATIVE_TIME" property="cumulativeTime" jdbcType="VARCHAR"/>
        <result column="REACTIVE_POWER" property="reactivePower" jdbcType="VARCHAR"/>
        <result column="POWER_FACTOR" property="powerFactor" jdbcType="VARCHAR"/>
        <result column="OIL_PRESSURE" property="oilPressure" jdbcType="VARCHAR"/>
        <result column="CASI_PRESSUER" property="casiPressuer" jdbcType="VARCHAR"/>
        <result column="DYNA_LIQU_LEV_DEPTH" property="dynaLiquLevDepth" jdbcType="VARCHAR"/>
        <result column="PUMP_DEPTH" property="pumpDepth" jdbcType="VARCHAR"/>
        <result column="SINK_DEGR" property="sinkDegr" jdbcType="VARCHAR"/>
        <result column="PUMP_DIAM" property="pumpDiam" jdbcType="VARCHAR"/>
        <result column="MOIS_CONT" property="moisCont" jdbcType="VARCHAR"/>
        <result column="PROD_LIQU_AMO" property="prodLiquAmo" jdbcType="VARCHAR"/>
        <result column="CRUD_OIL_DENS" property="crudOilDens" jdbcType="VARCHAR"/>
        <result column="STROKE" property="stroke" jdbcType="VARCHAR"/>
        <result column="STROKE_NUM" property="strokeNum" jdbcType="VARCHAR"/>
        <result column="UPSTROKE CURRENT" property="upstrokeCurrent" jdbcType="VARCHAR"/>
        <result column="DOWNSTROKE CURRENT" property="downstrokeCurrent" jdbcType="VARCHAR"/>
        <result column="MOTOR_OWER_TILIZATION" property="motorOwerTilization" jdbcType="VARCHAR"/>
        <result column="LIQUID_DENSITY" property="liquidDensity" jdbcType="VARCHAR"/>
        <result column="EFIC_HEAD" property="eficHead" jdbcType="VARCHAR"/>
        <result column="EFICIPOW" property="eficipow" jdbcType="VARCHAR"/>
        <result column="ACTIVE_TONLIQU_SCONSU" property="activeTonliquSconsu" jdbcType="VARCHAR"/>
        <result column="REACTIVE_TONLIQU_SCONSU" property="reactiveTonliquSconsu" jdbcType="VARCHAR"/>
        <result column="SYSTEM_POWER" property="systemPower" jdbcType="VARCHAR"/>
        <result column="BALANCED" property="balanced" jdbcType="VARCHAR"/>
        <result column="PUMP_EFIC" property="pumpEfic" jdbcType="VARCHAR"/>
        <result column="PERMEABILIT_K1" property="permeabilitK1" jdbcType="VARCHAR"/>
        <result column="PUMP_HANG_K2" property="pumpHangK2" jdbcType="VARCHAR"/>
        <result column="WELL_TRAJ_K3" property="wellTrajK3" jdbcType="VARCHAR"/>
        <result column="POWER_FACTOR_EVA_INDEX" property="powerFactorEvaIndex" jdbcType="VARCHAR"/>
        <result column="THIN_OIL_LIMIT_VALUE" property="thinOilLimitValue" jdbcType="VARCHAR"/>
        <result column="THIN_OIL_EVA_VALUE" property="thinOilEvaValue" jdbcType="VARCHAR"/>
        <result column="THICKENED_OIL_LIMIT_VALUE" property="thickenedOilLimitValue" jdbcType="VARCHAR"/>
        <result column="THICKENED_OIL_EVA_VALUE" property="thickenedOilEvaValue" jdbcType="VARCHAR"/>
        <result column="SYSTEM_POWER_LIMIT_VALUE" property="systemPowerLimitValue" jdbcType="VARCHAR"/>
        <result column="SYSTEM_POWER_EVA_VALUE" property="systemPowerEvaValue" jdbcType="VARCHAR"/>
        <result column="BALANCED_EVA_INDEX" property="balancedEvaIndex" jdbcType="VARCHAR"/>
        <result column="POWER_FACTOR_EVA_RESULT" property="powerFactorEvaResult" jdbcType="VARCHAR"/>
        <result column="SYSTEM_POWER_EVA_RESULT" property="systemPowerEvaResult" jdbcType="VARCHAR"/>
        <result column="BALANCED_EVA_RESULT" property="balancedEvaResult" jdbcType="VARCHAR"/>
        <result column="COMPREHENSIVE_EVA" property="comprehensiveEva" jdbcType="VARCHAR"/>
    </resultMap>
    <resultMap id="ExcelLogResultMap" type="com.petrochina.e7.monitor.pojo.ExcelLog">
        <id column="ID" property="id" jdbcType="INTEGER"/>
        <result column="EXCEL_NAME" property="excelName" jdbcType="VARCHAR"/>
        <result column="UPLOAD_TIME" property="uploadTime" jdbcType="TIMESTAMP"/>
    </resultMap>

    <!--插入数据-->
    <insert id="insertList" parameterType="java.util.List" useGeneratedKeys="true" keyProperty="id">
        insert into
        e7_mnt_mechanical_excel (EXCEL_NAME, ORG_ID,
        ORG_NAME, FACTORY_CATAGORY, MINE_CATAGORY,
        TEAM_CATAGORY, SERIAL_NUMBER, WELL_NUMBER,
        TEST_DATE, PUMPING_MODEL, PUMP_FACTORY_DATE,
        PUMP_MANU, MOTOR_MODEL, MOTOR_ELIMINATION_EQUIP,
        MOTOR_RATE_POW, MOTOR_RATE_CURRENT, MOTOR_RATE_VOLTAGE,
        MOTOR_RATE_SPEED, MOTOR_FACTORY_DATE, MOTOR_MANU,
        DBOX_MODEL, DBOX_FACTORY_DATE, DBOX_COMPENSATION,
        DBOX_MANU, DBOX_OPER_FREQUENCY, DBOX_OPER_VLTAGE,
        OIL_TYPE, BLOCK_PERMEABILITY, WELL_TRAJ,
        OPER_FREQUENCY, RUNTIME_DAY, ACTIVE_POWER,
        NEGATIVE_BATTERY, CUMULATIVE_TIME, REACTIVE_POWER,
        POWER_FACTOR, OIL_PRESSURE, CASI_PRESSUER,
        DYNA_LIQU_LEV_DEPTH, PUMP_DEPTH, SINK_DEGR,
        PUMP_DIAM, MOIS_CONT, PROD_LIQU_AMO,
        CRUD_OIL_DENS, STROKE, STROKE_NUM,
        UPSTROKE_CURRENT, DOWNSTROKE_CURRENT, MOTOR_OWER_TILIZATION,
        LIQUID_DENSITY, EFIC_HEAD, EFICIPOW,
        ACTIVE_TONLIQU_SCONSU, REACTIVE_TONLIQU_SCONSU,
        SYSTEM_POWER, BALANCED, PUMP_EFIC,
        PERMEABILIT_K1, PUMP_HANG_K2, WELL_TRAJ_K3, POWER_FACTOR_EVA_INDEX,
        THIN_OIL_LIMIT_VALUE, THIN_OIL_EVA_VALUE, THICKENED_OIL_LIMIT_VALUE, THICKENED_OIL_EVA_VALUE,
        SYSTEM_POWER_LIMIT_VALUE, SYSTEM_POWER_EVA_VALUE, BALANCED_EVA_INDEX, POWER_FACTOR_EVA_RESULT,
        SYSTEM_POWER_EVA_RESULT, BALANCED_EVA_RESULT, COMPREHENSIVE_EVA
        ) values
        <foreach collection="list" item="info" separator=",">
            ( #{info.excelName}, #{info.orgId},
            #{info.orgName}, #{info.factoryCatagory}, #{info.mineCatagory},
            #{info.teamCatagory}, #{info.serialNumber}, #{info.wellNumber},
            #{info.testDate}, #{info.pumpingModel}, #{info.pumpFactoryDate},
            #{info.pumpManu}, #{info.motorModel}, #{info.motorEliminationEquip},
            #{info.motorRatePow}, #{info.motorRateCurrent}, #{info.motorRateVoltage},
            #{info.motorRateSpeed}, #{info.motorFactoryDate}, #{info.motorManu},
            #{info.dboxModel}, #{info.dboxFactoryDate}, #{info.dboxCompensation},
            #{info.dboxManu}, #{info.dboxOperFrequency}, #{info.dboxOperVltage},
            #{info.oilType}, #{info.blockPermeability}, #{info.wellTraj},
            #{info.operFrequency}, #{info.runtimeDay}, #{info.activePower},
            #{info.negativeBattery}, #{info.cumulativeTime}, #{info.reactivePower},
            #{info.powerFactor}, #{info.oilPressure}, #{info.casiPressuer},
            #{info.dynaLiquLevDepth}, #{info.pumpDepth}, #{info.sinkDegr},
            #{info.pumpDiam}, #{info.moisCont}, #{info.prodLiquAmo},
            #{info.crudOilDens}, #{info.stroke}, #{info.strokeNum},
            #{info.upstrokeCurrent}, #{info.downstrokeCurrent}, #{info.motorOwerTilization},
            #{info.liquidDensity}, #{info.eficHead}, #{info.eficipow},
            #{info.activeTonliquSconsu}, #{info.reactiveTonliquSconsu},
            #{info.systemPower}, #{info.balanced}, #{info.pumpEfic},
            #{info.permeabilitK1}, #{info.pumpHangK2}, #{info.wellTrajK3},
            #{info.powerFactorEvaIndex}, #{info.thinOilLimitValue},
            #{info.thinOilEvaValue}, #{info.thickenedOilLimitValue},
            #{info.thickenedOilEvaValue}, #{info.systemPowerLimitValue},
            #{info.systemPowerEvaValue}, #{info.balancedEvaIndex},
            #{info.powerFactorEvaResult}, #{info.systemPowerEvaResult},
            #{info.balancedEvaResult}, #{info.comprehensiveEva}

            )
        </foreach>
    </insert>
    <!--查询数据-->
    <select id="findDataByParam" parameterType="String" resultMap="BaseResultMap">
    select
        *
    FROM
        e7_mnt_mechanical_excel
    where
        excel_name =#{param}

    </select>
    <!-- 插入日志-->
    <insert id="fetchExcelLog"  parameterType="com.petrochina.e7.monitor.pojo.ExcelLog" useGeneratedKeys="true" keyProperty="id">
        insert   into   e7_mnt_excel_log (excel_name ,upload_time) values
        (
        #{excelName},#{uploadTime}
        )
    </insert>
    <!--查询是否重复-->
    <select id="findOriginalFilename"  parameterType="String" resultType="Integer">
        select count(1)  from  e7_mnt_excel_log   where  excel_name =#{excelName}
    </select>


    <select id="findExcelLogList" resultMap="ExcelLogResultMap">
        select * from  e7_mnt_excel_log order by upload_time  desc
    </select>
</mapper>